
var reactii = [

[
	{coef:2, id:'FR', nume:"Ca"},
	{coef:1, id: 'SR', nume:"O2"},
	{coef:2, id: 'FP', nume:"CaO"},
	{r:1, reactie: "2Ca + O2 = 2CaO"}
],

[
	{coef:2, id:'FR', nume:"Mg"},
	{coef:1, id: 'SR', nume:"O2"},
	{coef:2, id: 'FP' , nume:"MgO"},
	{r:2, reactie: "2Mg + O2 = 2MgO"}
],

[
	{coef:2, id:'FR', nume:"H2"},
	{coef:1, id: 'SR', nume:"O2"},
	{coef:2, id: 'FP', nume:"H2O"},
	{r:3, reactie: "2H2 + O2 = 2H2O"}
],

[
	{coef:4, id:'FR', nume:"Al"},
	{coef:3, id: 'SR', nume:"O2"},
	{coef:2, id: 'FP', nume:"Al2O3"},
	{r: 4, reactie: "4Al + 3O2 = 2Al2O3"}
],

[
	{coef:1, id:'FR', nume:"FeCl3"},
	{coef:3, id: 'SR', nume:"KOH"},
	{coef:3, id: 'FP', nume:"KCl"},
	{coef:1, id: 'LP', nume:"Fe(OH)3"},
	{r: 5, reactie: "FeCl3 + 3KOH = 3KCl + Fe(OH)3"}
],

[
	{coef:1, id:'FR', nume:"Mg"},
	{coef:2, id: 'SR', nume:"HCl"},
	{coef:1, id: 'FP', nume:"MgCl2"},
	{coef:1, id: 'LP', nume:"H2"},
	{r: 6, reactie: "Mg + 2HCl = MgCl2 + H2"}
],

[
	{coef:2, id:'FR', nume:"Al"},
	{coef:3, id: 'SR', nume:"S"},
	{coef:1, id: 'FP', nume:"Al2S3"},
	{r: 7, reactie: "2Al + 3S = Al2S3"}
],

[
	{coef:1, id:'FR', nume:"Zn"},
	{coef:2, id: 'SR', nume:"HCl"},
	{coef:1, id: 'FP', nume:"ZnCl2"},
	{coef:1, id: 'LP', nume:"H2"},
	{r: 8, reactie: "Zn + 2HCl = ZnCl2 + H2"}
],

[
	{coef:2, id:'FR', nume:"Al(OH)3"},
	{coef:1, id: 'FP', nume:"Al2O3"},
	{coef:3, id: 'LP', nume:"H2O"},
	{r: 9, reactie: "2Al(OH)3 = Al2O3 + 3H2O"}
],

[
	{coef:1, id:'FR', nume:"CaCO3"},
	{coef:1, id: 'FP', nume:"CaO"},
	{coef:1, id: 'LP', nume:"CO2"},
	{r: 10, reactie: "CaCO3 = CaO + CO2"}
],

[
	{coef:4, id:'FR', nume:"NaNO3"},
	{coef:4, id: 'FP', nume:"NaNO2"},
	{coef:2, id: 'LP', nume:"O2"},
	{r: 11, reactie: "4NaNO3 + 4NaNO2  = 2O2"}
],

[
	{coef:1, id:'FR', nume:"Zn"},
	{coef:1, id: 'SR', nume:"H2SO4"},
	{coef:1, id: 'FP', nume:"ZnSO4"},
	{coef:1, id: 'LP', nume:"H2"},
	{r: 12, reactie: "Zn + H2SO4 = ZnSO4 + H2"}
],

[
	{coef:4, id:'FR', nume:"Na"},
	{coef:1, id: 'SR', nume:"O2"},
	{coef:2, id: 'FP', nume:"Na2O"},
	{r: 13, reactie: "4Na + O2 = 2Na2O"}
],

[
	{coef:1, id:'FR', nume:"H2SO4"},
	{coef:1, id: 'SR', nume:"BaCl2"},
	{coef:1, id: 'FP', nume:"BaSO4"},
	{coef:2, id: 'LP', nume:"HCl"},
	{r: 14, reactie: "H2SO4 + BaCl2 = BaSO4 + 2HCl"}
],

[
	{coef:1, id:'FR', nume:"HCl"},
	{coef:1, id: 'SR', nume:"AgNO3"},
	{coef:1, id: 'FP', nume:"HNO3"},
	{coef:1, id: 'LP', nume:"AgCl"},
	{r: 15, reactie: "HCl + AgNO3 = HNO3 + AgCl"}
],

[
	{coef:2, id:'FR', nume:"NaOH"},
	{coef:1, id: 'SR', nume:"CuSO4"},
	{coef:1, id: 'FP', nume:"Na2SO4"},
	{coef:1, id: 'LP', nume:"Cu(OH)2"},
	{r: 16, reactie: "2NaOH + CuSO4 = Na2SO4 + Cu(OH)2"}
],

[
	{coef:3, id:'FR', nume:"NaOH"},
	{coef:1, id: 'SR', nume:"FeCl3"},
	{coef:3, id: 'FP', nume:"NaCl"},
	{coef:1, id: 'LP', nume:"Fe(OH)3"},
	{r: 17, reactie: "3NaOH + FeCl3 = 3NaCl + Fe(OH)3"}
],

[
	{coef:1, id:'FR', nume:"KI"},
	{coef:1, id: 'SR', nume:"AgNO3"},
	{coef:1, id: 'FP', nume:"KNO3"},
	{coef:1, id: 'LP', nume:"AgI"},
	{r: 18, reactie: "KI + AgNO3 = KNO3 + AgI"}
],

[
	{coef:1, id:'FR', nume:"KBr"},
	{coef:1, id: 'SR', nume:"AgNO3"},
	{coef:1, id: 'FP', nume:"KNO3"},
	{coef:1, id: 'LP', nume:"AgBr"},
	{r: 19, reactie: "KBr + AgNO3 = KNO3 + AgBr"}
],

[
	{coef:2, id:'FR', nume:"HgO"},
	{coef:1, id: 'FP', nume:"O2"},
	{coef:2, id: 'LP', nume:"Hg"},
	{r: 20, reactie: "2HgO = O2 + 2Hg"}
]
]

let randInd;

let labelsVec=[];

let accept=0;

function signs(id,i ){

  let y=reactii[randInd][i].id;
  if(y==="SR" || y==="LP"){
  	    let q=document.createElement("LABEL");
        q.innerHTML = "+";
        document.getElementById("user-input").insertBefore(q, document.getElementsByTagName("button")[i]);
  }
  else if(y==="FP"){
  	    let q=document.createElement("LABEL");
        q.innerHTML = "=";
        document.getElementById("user-input").insertBefore(q, document.getElementsByTagName("button")[i]);
  }

}

let q=[];

function newfunction(x,i) {
	 q[i]=1;
   	x.style.display="none";
   	let y = document.createElement("INPUT");
     y.setAttribute("type", "text");
     document.getElementById("user-input").insertBefore(y, x);
     return true;


}

function addPlusBttn(x,i){
	var plus=document.createElement("BUTTON");
	plus.innerHTML = "+";
	document.getElementById("user-input").insertBefore(plus, x);
    plus.type="button";
    plus.addEventListener('click', function(){
    newfunction(plus,i);
})

}

function createLabels(randInd){
    for(let i=0;i<reactii[randInd].length-1;i++)
    	{
        q[i]=0;
    	labelsVec[i]=document.createElement("LABEL");
        labelsVec[i].innerHTML = reactii[randInd][i].nume;
        document.getElementById("user-input").appendChild(labelsVec[i]);
        addPlusBttn(labelsVec[i],i);
        signs(reactii[randInd][i].id, i);

    }
}

let mistakesCounter = 0;
function tryAgain(){
    document.getElementById("rezultat").style.display="none";
	document.getElementById("content").style.display="flex";
	 	
}

function gresit(){
	document.getElementById("content").style.display="none";
	document.getElementById("rezultat").style.display="flex";
	document.getElementById("rezultat").style.background="rebeccapurple";
	document.getElementById("resulttext").innerHTML="Gresit!";
	mistakesCounter++;
	if(mistakesCounter===3){
		document.getElementById("resulttext").innerHTML="Ai gresit de 3 ori!";
		document.getElementById("tryAgain").style.display="none";
		let raspunsuri;
        raspunsuri = document.getElementById("raspunsuri");
        raspunsuri.innerHTML = "Rezolvare: " + reactii[randInd][reactii[randInd].length-1].reactie;
        accept=1;
	}

}

function corect(){

	document.getElementById("content").style.display="none";
	document.getElementById("rezultat").style.display="flex";
	document.getElementById("rezultat").style.background="purple";
	document.getElementById("resulttext").innerHTML="Corect!";
	document.getElementById("tryAgain").style.display="none";
    accept=1;
}


function verif(){
	let ifi =0;
	let raport=1;
	let ok=0;
	let rapIn;
	for (let i=0;i<reactii[randInd].length-1;i++)
		{
		 let x;
		 let y;

		if(q[i]===1){
		if(document.getElementsByTagName("input")[i-ifi].value)
		x = Number(document.getElementsByTagName("input")[i-ifi].value);

	}
	    else { x=1; ifi++;}
	    if(q[0]===1)
	    {if(document.getElementsByTagName("input")[0])	
		y = Number(document.getElementsByTagName("input")[0].value);}
	    
	    else y=1;
	    rapIn = y/reactii[randInd][0].coef;
	    raport = x/reactii[randInd][i].coef;
	    if(raport!==rapIn)  ok++;
	    x=1;
	}
	   if(ok!==0) gresit();
	else corect();
}

function flow(){
    randInd = Math.floor(Math.random() * reactii.length);
    createLabels(randInd);
}

flow();